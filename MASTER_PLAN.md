# MASTER PLAN â€“ Káº¾ HOáº CH HOÃ€N THIá»†N 100% 1Beauty.asia

**âš ï¸ QUAN TRá»ŒNG: ÄÃ¢y lÃ  "xÆ°Æ¡ng sá»‘ng" triá»ƒn khai, KHÃ”NG ÄÆ¯á»¢C LÃ€M Lá»†CH THá»¨ Tá»°**

**NgÃ y táº¡o:** $(date)  
**Version:** 1.1 (Clarification & Rebase)  
**Tráº¡ng thÃ¡i:** Äang triá»ƒn khai

---

## ğŸš¨ CAM Káº¾T NGUYÃŠN Táº®C (Ráº¤T QUAN TRá»ŒNG â€“ CHá»T NGAY)

**âš ï¸ Äá»ŒC Ká»¸ PHáº¦N NÃ€Y TRÆ¯á»šC KHI Báº®T Äáº¦U Báº¤T Ká»² Má»¤C NÃ€O**

MÃ¬nh Ä‘á»“ng Ã½ 100% vÃ  cam káº¿t giá»¯ tuyá»‡t Ä‘á»‘i cÃ¡c nguyÃªn táº¯c sau, tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i dá»± Ã¡n:

### âœ… CAM Káº¾T TUYá»†T Äá»I

1. **KHÃ”NG LAN MAN â€“ KHÃ”NG Ráº¼ NHÃNH**
   - Chá»‰ lÃ m Ä‘Ãºng nhá»¯ng gÃ¬ trong Master Plan
   - KhÃ´ng tá»± Ã½ thÃªm features ngoÃ i káº¿ hoáº¡ch
   - KhÃ´ng lÃ m cÃ¡c má»¥c khÃ´ng liÃªn quan

2. **ÄI ÄÃšNG THá»¨ Tá»° A â†’ B â†’ C â†’ D â†’ E â†’ F â†’ G â†’ H**
   - Pháº£i hoÃ n thÃ nh Pháº§n A trÆ°á»›c khi báº¯t Ä‘áº§u Pháº§n B
   - Pháº£i hoÃ n thÃ nh táº¥t cáº£ má»¥c trong má»™t pháº§n trÆ°á»›c khi chuyá»ƒn pháº§n
   - KhÃ´ng Ä‘Æ°á»£c nháº£y cÃ³c, bá» qua má»¥c nÃ o

3. **Má»–I Má»¤C = HOÃ€N THIá»†N 100% â†’ KIá»‚M TRA â†’ CHá»T â†’ Má»šI ÄÆ¯á»¢C QUA**
   - Má»—i má»¥c pháº£i hoÃ n thiá»‡n 100% trÆ°á»›c khi chuyá»ƒn má»¥c tiáº¿p theo
   - Pháº£i kiá»ƒm tra ká»¹ lÆ°á»¡ng sau khi hoÃ n thÃ nh
   - Pháº£i chá»‘t vÃ  Ä‘Ã¡nh dáº¥u hoÃ n thÃ nh trÆ°á»›c khi tiáº¿p tá»¥c

4. **KHÃ”NG Cáº®T NGáº®N â€“ KHÃ”NG RÃšT Gá»ŒN SAU VÃ€I PHIÃŠN CHAT**
   - KhÃ´ng Ä‘Æ°á»£c rÃºt gá»n scope vÃ¬ "má»‡t" hoáº·c "lÃ¢u"
   - KhÃ´ng Ä‘Æ°á»£c bá» qua deliverables
   - Pháº£i lÃ m Ä‘áº§y Ä‘á»§ nhÆ° Ä‘Ã£ Ä‘á»‹nh nghÄ©a

5. **KHÃ”NG "Táº M ÄÆ¯á»¢C" â€“ KHÃ”NG TODO â€“ KHÃ”NG PLACEHOLDER**
   - KhÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ code táº¡m
   - KhÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ TODO comments
   - KhÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ placeholder functions
   - Má»i thá»© pháº£i hoÃ n chá»‰nh, cháº¡y Ä‘Æ°á»£c

6. **KHÃ”NG Äá»‚ AI (Ká»‚ Cáº¢ CURSOR) LÃI Káº¾ HOáº CH**
   - Chá»‰ lÃ m theo Master Plan
   - Náº¿u AI Ä‘á» xuáº¥t Ä‘iá»u gÃ¬ ngoÃ i káº¿ hoáº¡ch â†’ tá»« chá»‘i
   - Náº¿u AI muá»‘n thay Ä‘á»•i thá»© tá»± â†’ tá»« chá»‘i

7. **Má»ŒI QUYáº¾T Äá»ŠNH CUá»I CÃ™NG PHáº¢I PHÃ™ Há»¢P MASTER PLAN**
   - Má»i thay Ä‘á»•i pháº£i Ä‘Æ°á»£c review vá»›i Master Plan
   - Náº¿u conflict â†’ Æ°u tiÃªn Master Plan
   - Náº¿u cáº§n thay Ä‘á»•i Master Plan â†’ pháº£i Ä‘Æ°á»£c approve trÆ°á»›c

---

## ğŸ” EXECUTION PROTOCOL (QUY TRÃŒNH TRIá»‚N KHAI Báº®T BUá»˜C)

**âš ï¸ ÃP Dá»¤NG CHO Tá»ªNG Má»¤C NHá» (vÃ­ dá»¥: A2.1, A2.2, A3.1â€¦)**

Má»—i má»¥c Ä‘á»u pháº£i Ä‘i theo chu ká»³ 6 bÆ°á»›c sau. **KHÃ”NG ÄÆ¯á»¢C Bá» QUA BÆ¯á»šC NÃ€O.**

### 1ï¸âƒ£ PHÃ‚N TÃCH HIá»†N TRáº NG (READ-ONLY)

**Má»¥c Ä‘Ã­ch:** Hiá»ƒu rÃµ tÃ¬nh tráº¡ng hiá»‡n táº¡i trÆ°á»›c khi lÃ m gÃ¬

**Quy táº¯c:**
- âŒ KHÃ”NG code
- âŒ KHÃ”NG sá»­a
- âŒ KHÃ”NG Ä‘á» xuáº¥t giáº£i phÃ¡p vá»™i
- âœ… CHá»ˆ Ä‘á»c, phÃ¢n tÃ­ch, liá»‡t kÃª

**CÃ¢u há»i pháº£i tráº£ lá»i:**
- Äang cÃ³ gÃ¬?
- File nÃ o liÃªn quan?
- Báº£ng/cá»™t nÃ o trong database?
- Code hiá»‡n táº¡i nhÆ° tháº¿ nÃ o?
- Rá»§i ro gÃ¬ cÃ³ thá»ƒ xáº£y ra?
- CÃ³ conflict gÃ¬ khÃ´ng?

**ğŸ‘‰ Náº¿u chÆ°a xong bÆ°á»›c nÃ y â†’ KHÃ”NG ÄÆ¯á»¢C lÃ m bÆ°á»›c 2**

**Output:** BÃ¡o cÃ¡o hiá»‡n tráº¡ng (cÃ³ thá»ƒ viáº¿t ngáº¯n gá»n, nhÆ°ng pháº£i Ä‘áº§y Ä‘á»§)

---

### 2ï¸âƒ£ Äá»ŠNH NGHÄ¨A "HOÃ€N THIá»†N 100%" (DEFINITION OF DONE)

**Má»¥c Ä‘Ã­ch:** XÃ¡c Ä‘á»‹nh rÃµ rÃ ng khi nÃ o gá»i lÃ  XONG

**Quy táº¯c:**
- Pháº£i viáº¿t rÃµ, cá»¥ thá»ƒ
- CÃ³ thá»ƒ Ä‘o lÆ°á»ng Ä‘Æ°á»£c
- CÃ³ thá»ƒ verify Ä‘Æ°á»£c

**CÃ¢u há»i pháº£i tráº£ lá»i:**
- Khi nÃ o gá»i lÃ  XONG?
- Output báº¯t buá»™c lÃ  gÃ¬?
- File nÃ o pháº£i tá»“n táº¡i?
- Test nÃ o pháº£i pass?
- Checklist nÃ o pháº£i Ä‘áº§y Ä‘á»§?
- CÃ³ SQL nÃ o cáº§n táº¡o khÃ´ng?
- CÃ³ documentation nÃ o cáº§n viáº¿t khÃ´ng?

**ğŸ‘‰ KhÃ´ng rÃµ "xong lÃ  gÃ¬" â†’ KHÃ”NG ÄÆ¯á»¢C code**

**Output:** Definition of Done cho má»¥c nÃ y (viáº¿t rÃµ rÃ ng, cá»¥ thá»ƒ)

---

### 3ï¸âƒ£ CHECKLIST Ká»¸ THUáº¬T (LOCK SCOPE)

**Má»¥c Ä‘Ã­ch:** XÃ¡c Ä‘á»‹nh rÃµ pháº¡m vi cÃ´ng viá»‡c, trÃ¡nh lÃ m lan man

**Quy táº¯c:**
- Liá»‡t kÃª Táº¤T Cáº¢ viá»‡c cáº§n lÃ m
- Liá»‡t kÃª Táº¤T Cáº¢ viá»‡c KHÃ”NG Ä‘Æ°á»£c lÃ m
- Lock scope - khÃ´ng má»Ÿ rá»™ng

**Checklist pháº£i cÃ³:**
- âœ… Danh sÃ¡ch viá»‡c Ä‘Æ°á»£c phÃ©p lÃ m
- âŒ Danh sÃ¡ch viá»‡c cáº¥m lÃ m
- ğŸ“ Files sáº½ Ä‘Æ°á»£c táº¡o/sá»­a
- ğŸ—„ï¸ Database changes (náº¿u cÃ³)
- ğŸ§ª Tests cáº§n lÃ m (náº¿u cÃ³)

**ğŸ‘‰ CÃ¡i gÃ¬ ngoÃ i checklist â†’ KHÃ”NG ÄÆ¯á»¢C Äá»¤NG**

**Output:** Checklist ká»¹ thuáº­t (cÃ³ thá»ƒ dÃ¹ng format trong Master Plan, nhÆ°ng pháº£i cá»¥ thá»ƒ hÃ³a)

---

### 4ï¸âƒ£ CHá»ˆ THá»Š CHO CURSOR (PROMPT CHÃNH THá»¨C)

**Má»¥c Ä‘Ã­ch:** ÄÆ°a ra chá»‰ thá»‹ rÃµ rÃ ng, khÃ´ng vÃ²ng vo

**Quy táº¯c:**
- 1 prompt duy nháº¥t, rÃµ rÃ ng
- KhÃ´ng vÃ²ng vo
- KhÃ´ng má»Ÿ rá»™ng
- KhÃ´ng "tá»± suy luáº­n thÃªm"
- Dá»±a trÃªn bÆ°á»›c 1, 2, 3

**Prompt pháº£i bao gá»“m:**
- Má»¥c tiÃªu cá»¥ thá»ƒ
- Scope (tá»« checklist)
- Definition of Done
- Constraints (tá»« Master Plan)
- Deliverables mong Ä‘á»£i

**Output:** Prompt sáºµn sÃ ng Ä‘á»ƒ gá»­i cho Cursor/AI

---

### 5ï¸âƒ£ KIá»‚M TRA â€“ SOI Lá»–I â€“ CHá»T

**Má»¥c Ä‘Ã­ch:** Äáº£m báº£o output Ä‘Ãºng nhÆ° mong Ä‘á»£i

**Quy táº¯c:**
- Pháº£i kiá»ƒm tra ká»¹ lÆ°á»¡ng
- Soi lá»—i nghiÃªm ngáº·t
- Chá»‰ chá»‘t khi thá»±c sá»± hoÃ n thÃ nh

**Checklist kiá»ƒm tra:**
- âœ… Äá»‘i chiáº¿u vá»›i Master Plan
- âœ… Äá»‘i chiáº¿u vá»›i Definition of Done
- âœ… Äá»‘i chiáº¿u vá»›i Checklist ká»¹ thuáº­t
- âœ… Test (náº¿u cÃ³)
- âœ… Code review (náº¿u cÃ³)
- âœ… Documentation (náº¿u cÃ³)

**Náº¿u:**
- âŒ SAI â†’ quay láº¡i bÆ°á»›c 4 (cÃ³ thá»ƒ cáº§n Ä‘iá»u chá»‰nh prompt)
- âœ… ÄÃšNG â†’ ÄÃNH Dáº¤U HOÃ€N THÃ€NH

**Output:** Káº¿t quáº£ kiá»ƒm tra (Pass/Fail) + LÃ½ do

---

### 6ï¸âƒ£ GHI NHáº¬N TIáº¾N Äá»˜

**Má»¥c Ä‘Ã­ch:** Cáº­p nháº­t tiáº¿n Ä‘á»™ vÃ  Ä‘Ã¡nh dáº¥u má»¥c Ä‘Ã£ hoÃ n thÃ nh

**Quy táº¯c:**
- Cáº­p nháº­t ngay sau khi chá»‘t
- KhÃ´ng Ä‘Æ°á»£c quÃªn
- Pháº£i Ä‘áº§y Ä‘á»§ thÃ´ng tin

**Ná»™i dung cáº­p nháº­t:**
- ÄÃ¡nh dáº¥u checkbox trong `TIEN_DO_HOAN_THIEN.md`
- Ghi ngÃ y hoÃ n thÃ nh
- Ghi ngÆ°á»i thá»±c hiá»‡n (náº¿u cÃ³)
- Ghi ghi chÃº (náº¿u cÃ³)
- List deliverables Ä‘Ã£ táº¡o
- **ÄÃ¡nh dáº¥u tráº¡ng thÃ¡i:** DONE / UI_COMPLETE / REVIEW_LATER (xem Ä‘á»‹nh nghÄ©a bÃªn dÆ°á»›i)
- Chá»‘t: "Má»¤C NÃ€Y ÄÃƒ ÄÃ“NG â€“ KHÃ”NG ÄÆ¯á»¢C Sá»¬A Láº I TRá»ª KHI CÃ“ BUG NGHIÃŠM TRá»ŒNG"

**Output:** File `TIEN_DO_HOAN_THIEN.md` Ä‘Æ°á»£c cáº­p nháº­t

---

## ğŸ“‹ COMPLETION EVIDENCE (LITE) - v1.1

**âš ï¸ THAY Äá»”I QUAN TRá»ŒNG:** Tá»« v1.1, khÃ´ng cÃ²n yÃªu cáº§u táº¡o Completion Report file riÃªng.

### Äá»‹nh nghÄ©a Completion Evidence (Lite)

**Completion Evidence (Lite)** cho má»—i má»¥c bao gá»“m:

1. **Code diff Ä‘Ã£ hoÃ n thiá»‡n**
   - âœ… Code khÃ´ng cÃ³ TODO
   - âœ… Code khÃ´ng cÃ³ placeholder
   - âœ… Code cháº¡y Ä‘Æ°á»£c, khÃ´ng lá»—i

2. **SQL verification script** (náº¿u má»¥c cÃ³ liÃªn quan database)
   - âœ… File trong `database/verifications/`
   - âœ… Script idempotent, cÃ³ thá»ƒ cháº¡y nhiá»u láº§n
   - âœ… Verify schema, RLS, data integrity

3. **Update Ä‘áº§y Ä‘á»§ vÃ o TIEN_DO_HOAN_THIEN.md**
   - âœ… ÄÃ¡nh dáº¥u checkbox
   - âœ… Ghi deliverables
   - âœ… Ghi tráº¡ng thÃ¡i (DONE / UI_COMPLETE / REVIEW_LATER)
   - âœ… Ghi notes náº¿u cáº§n

**â¡ï¸ Completion Evidence (Lite) Ä‘Æ°á»£c xem lÃ  báº±ng chá»©ng hoÃ n thÃ nh há»£p lá»‡.**

**âŒ KHÃ”NG cáº§n:**
- Completion Report file riÃªng (`docs/*_completion_report.md`)
- BÃ¡o cÃ¡o dÃ i dÃ²ng
- Documentation chi tiáº¿t ngoÃ i code comments

---

## ğŸ·ï¸ TRáº NG THÃI TIáº¾N Äá»˜ - v1.1

**CÃ¡c tráº¡ng thÃ¡i chÃ­nh thá»©c trong TIEN_DO_HOAN_THIEN.md:**

### DONE
- âœ… HoÃ n thiá»‡n 100%, Ä‘Ã£ khÃ³a
- âœ… Code production-ready
- âœ… Logic hoÃ n chá»‰nh
- âœ… **Quy táº¯c:** KhÃ´ng Ä‘Æ°á»£c sá»­a má»¥c DONE trá»« khi cÃ³ bug nghiÃªm trá»ng

### UI_COMPLETE
- âœ… UI hoÃ n chá»‰nh
- âœ… CRUD hoáº¡t Ä‘á»™ng
- âœ… RLS-safe
- âœ… KhÃ´ng placeholder
- âš ï¸ Business logic nÃ¢ng cao sáº½ Ä‘Æ°á»£c audit láº¡i á»Ÿ Phase D

### REVIEW_LATER
- âœ… ÄÃ£ cháº¡y Ä‘Æ°á»£c
- âœ… UI + CRUD cÆ¡ báº£n OK
- âš ï¸ Cáº§n audit láº¡i á»Ÿ phase logic (Phase D)
- âš ï¸ CÃ³ thá»ƒ cÃ³ business rules chÆ°a Ä‘áº§y Ä‘á»§

**Quy táº¯c:**
- CÃ¡c má»¥c UI_COMPLETE / REVIEW_LATER sáº½ Ä‘Æ°á»£c audit láº¡i á»Ÿ Phase D
- KHÃ”NG xÃ³a code
- KHÃ”NG lÃ m láº¡i UI
- CHá»ˆ audit logic khi Ä‘áº¿n Phase D

---

## âš ï¸ LÆ¯U Ã QUAN TRá»ŒNG

1. **Má»—i má»¥c pháº£i Ä‘i qua Ä‘á»§ 6 bÆ°á»›c trÃªn**
2. **KhÃ´ng Ä‘Æ°á»£c bá» qua bÆ°á»›c nÃ o, dÃ¹ cÃ³ váº» "nhá»"**
3. **Náº¿u tháº¥y mÃ¬nh Ä‘ang lÃ m sai quy trÃ¬nh â†’ Dá»ªNG Láº I vÃ  lÃ m láº¡i Ä‘Ãºng**
4. **Náº¿u AI (Cursor) Ä‘á» xuáº¥t bá» qua bÆ°á»›c nÃ o â†’ Tá»ª CHá»I**
5. **Náº¿u AI muá»‘n lÃ m nhanh, rÃºt gá»n â†’ Tá»ª CHá»I**
6. **LuÃ´n Ä‘á»‘i chiáº¿u vá»›i Master Plan trÆ°á»›c khi quyáº¿t Ä‘á»‹nh**

---

## ğŸ“‹ QUY Táº®C TRIá»‚N KHAI (TÃ“M Táº®T)

1. **Thá»© tá»± báº¯t buá»™c:** Pháº£i lÃ m theo thá»© tá»± A â†’ B â†’ C â†’ D â†’ E â†’ F â†’ G â†’ H
2. **HoÃ n thiá»‡n 100%:** Má»—i má»¥c pháº£i hoÃ n thiá»‡n 100%, KHÃ”NG Ä‘Æ°á»£c Ä‘á»ƒ placeholder, TODO, hoáº·c code táº¡m
3. **SQL Ä‘áº§y Ä‘á»§:** Náº¿u cáº§n SQL, pháº£i cung cáº¥p SQL hoÃ n chá»‰nh, test Ä‘Æ°á»£c
4. **BÃ¡o cÃ¡o tiáº¿n Ä‘á»™:** Má»—i má»¥c hoÃ n thÃ nh pháº£i cáº­p nháº­t vÃ o `TIEN_DO_HOAN_THIEN.md`
5. **Database tháº­t:** Táº¥t cáº£ database pháº£i hoÃ n thiá»‡n 100% Ä‘á»ƒ váº­n hÃ nh tháº­t sá»±
6. **BÃ¡o lá»—i:** Náº¿u phÃ¡t hiá»‡n sai sÃ³t tá»« AI, pháº£i bÃ¡o láº¡i ngay
7. **Execution Protocol:** Má»—i má»¥c pháº£i Ä‘i qua Ä‘á»§ 6 bÆ°á»›c (PhÃ¢n tÃ­ch â†’ Äá»‹nh nghÄ©a â†’ Checklist â†’ Chá»‰ thá»‹ â†’ Kiá»ƒm tra â†’ Ghi nháº­n)

---

## PHáº¦N A â€“ Ná»€N MÃ“NG Báº®T BUá»˜C (KHÃ”NG ÄÆ¯á»¢C LÃ€M SAI)

### A1. Chuáº©n hÃ³a kiáº¿n trÃºc & nguyÃªn táº¯c triá»ƒn khai

**Má»¥c tiÃªu:** XÃ¢y dá»±ng quy Æ°á»›c vÃ  triáº¿t lÃ½ lÃ m ná»n táº£ng cho toÃ n bá»™ dá»± Ã¡n

**Danh má»¥c:**

- [ ] **A1.1** Äá»‹nh nghÄ©a quy Æ°á»›c:
  - [ ] `frontend â†” backend â†” database` data flow
  - [ ] Data ownership (ai sá»Ÿ há»¯u data nÃ o)
  - [ ] Role & permission model
  - [ ] Single source of truth

- [ ] **A1.2** Chá»‘t triáº¿t lÃ½:
  - [ ] Supabase lÃ  backend duy nháº¥t
  - [ ] KhÃ´ng bypass RLS
  - [ ] KhÃ´ng hardcode role á»Ÿ frontend
  - [ ] Document triáº¿t lÃ½ trong file `ARCHITECTURE.md`

**âš ï¸ Cáº¢NH BÃO:** Náº¿u bá» qua A1 â†’ dá»± Ã¡n sáº½ nÃ¡t vá» sau

---

### A2. Chuáº©n hÃ³a DATABASE SCHEMA (CONSOLIDATION)

**Má»¥c tiÃªu:** Chá»‰ tá»“n táº¡i 1 schema chuáº©n, khÃ´ng cÃ²n SQL rá»i ráº¡c gÃ¢y xung Ä‘á»™t

**Danh má»¥c:**

- [ ] **A2.1** Audit vÃ  liá»‡t kÃª táº¥t cáº£ SQL files:
  - [ ] `supabase_new_schema.sql`
  - [ ] `supabase_schema.sql`
  - [ ] Táº¥t cáº£ files trong `supabase/migrations/`
  - [ ] Táº¥t cáº£ `fix_*.sql` files
  - [ ] Táº¥t cáº£ `optimize_*.sql` files
  - [ ] Táº¥t cáº£ `seed_*.sql` files
  - [ ] Táº¥t cáº£ `setup_*.sql` files

- [ ] **A2.2** Consolidate schema:
  - [ ] Táº¡o file `database/schema_v1.0.sql` - Schema duy nháº¥t, chuáº©n
  - [ ] Merge táº¥t cáº£ changes tá»« cÃ¡c file rá»i ráº¡c
  - [ ] Resolve conflicts
  - [ ] Äáº£m báº£o khÃ´ng máº¥t data/structure nÃ o

- [ ] **A2.3** Chuáº©n hÃ³a naming:
  - [ ] Table naming convention
  - [ ] Column naming convention (snake_case)
  - [ ] Enum naming convention
  - [ ] Index naming convention
  - [ ] Foreign key naming convention

- [ ] **A2.4** Äá»‹nh nghÄ©a foreign keys & cascade rules:
  - [ ] Liá»‡t kÃª táº¥t cáº£ foreign keys
  - [ ] Quyáº¿t Ä‘á»‹nh ON DELETE CASCADE/NO ACTION/SET NULL
  - [ ] Quyáº¿t Ä‘á»‹nh ON UPDATE rules
  - [ ] Document trong schema

- [ ] **A2.5** Freeze schema v1.0:
  - [ ] Review toÃ n bá»™ schema
  - [ ] Test schema trÃªn local Supabase
  - [ ] Táº¡o file `database/schema_v1.0_FINAL.sql`
  - [ ] Archive cÃ¡c file SQL cÅ© vÃ o `database/archive/`
  - [ ] Update README vá»›i schema v1.0

**Deliverables:**
- `database/schema_v1.0_FINAL.sql` - Schema hoÃ n chá»‰nh, test Ä‘Æ°á»£c
- `database/migrations/` - Migrations chuáº©n hÃ³a (náº¿u cáº§n)
- Document schema trong `database/README.md`

---

### A3. RLS & SECURITY AUDIT (Cá»°C Ká»² QUAN TRá»ŒNG)

**Má»¥c tiÃªu:** KhÃ´ng user nÃ o Ä‘á»c/ghi Ä‘Æ°á»£c dá»¯ liá»‡u khÃ´ng thuá»™c quyá»n

**Danh má»¥c:**

- [ ] **A3.1** Audit RLS cho má»—i báº£ng:
  - [ ] `businesses`
  - [ ] `services`
  - [ ] `deals`
  - [ ] `team_members`
  - [ ] `media_items`
  - [ ] `reviews`
  - [ ] `blog_posts`
  - [ ] `business_blog_posts`
  - [ ] `profiles`
  - [ ] `registration_requests`
  - [ ] `orders`
  - [ ] `appointments`
  - [ ] `support_tickets`
  - [ ] `admin_users`
  - [ ] CÃ¡c báº£ng khÃ¡c (homepage_data, page_content, app_settings, announcements, membership_packages)

- [ ] **A3.2** Policy cho má»—i operation:
  - [ ] SELECT policies (public data vs private data)
  - [ ] INSERT policies (ai Ä‘Æ°á»£c insert)
  - [ ] UPDATE policies (ai Ä‘Æ°á»£c update)
  - [ ] DELETE policies (ai Ä‘Æ°á»£c delete)

- [ ] **A3.3** Role-based policies:
  - [ ] Anonymous users
  - [ ] Logged-in users
  - [ ] Business owners (chá»‰ Ä‘Æ°á»£c modify business cá»§a mÃ¬nh)
  - [ ] Admin users (full access vá»›i Ä‘iá»u kiá»‡n)
  - [ ] Staff members (future)

- [ ] **A3.4** Security audit:
  - [ ] Privilege escalation prevention
  - [ ] Public data vs private data boundary
  - [ ] Cross-tenant data leak prevention
  - [ ] SQL injection prevention (Supabase handles, nhÆ°ng cáº§n verify)

- [ ] **A3.5** Test matrix:
  - [ ] Test vá»›i anonymous user
  - [ ] Test vá»›i logged-in user
  - [ ] Test vá»›i business owner (chá»‰ business cá»§a mÃ¬nh)
  - [ ] Test vá»›i business owner (business cá»§a ngÆ°á»i khÃ¡c) â†’ pháº£i block
  - [ ] Test vá»›i admin
  - [ ] Test vá»›i moderator
  - [ ] Test vá»›i editor

- [ ] **A3.6** Táº¡o RLS policies file:
  - [ ] `database/rls_policies_v1.0.sql` - Táº¥t cáº£ RLS policies
  - [ ] Document tá»«ng policy
  - [ ] Test script Ä‘á»ƒ verify policies

**Deliverables:**
- `database/rls_policies_v1.0.sql` - RLS policies hoÃ n chá»‰nh
- `database/rls_test_script.sql` - Test script
- Document policies trong `database/SECURITY.md`

---

### A4. STORAGE & MEDIA SECURITY

**Má»¥c tiÃªu:** Setup storage buckets vÃ  policies an toÃ n

**Danh má»¥c:**

- [ ] **A4.1** Chuáº©n hÃ³a buckets:
  - [ ] `business-images` - HÃ¬nh áº£nh businesses
  - [ ] `business-logos` - Logos cá»§a businesses
  - [ ] `media-gallery` - Media items (gallery)
  - [ ] `user-avatars` - User avatars
  - [ ] `blog-images` - Blog images
  - [ ] Táº¡o SQL script Ä‘á»ƒ táº¡o buckets (náº¿u cÃ³ thá»ƒ) hoáº·c document manual steps

- [ ] **A4.2** Storage policies (upload):
  - [ ] Ai Ä‘Æ°á»£c upload vÃ o bucket nÃ o?
  - [ ] Size limits
  - [ ] File type restrictions
  - [ ] Path restrictions (vÃ­ dá»¥: `business-images/{business_id}/*`)

- [ ] **A4.3** Storage policies (download/view):
  - [ ] Public images (ai cÅ©ng xem Ä‘Æ°á»£c)
  - [ ] Private images (chá»‰ owner/admin xem Ä‘Æ°á»£c)
  - [ ] Business images (public nhÆ°ng path cÃ³ business_id)
  - [ ] User avatars (public hoáº·c private)

- [ ] **A4.4** Path structure:
  - [ ] `business-images/{business_id}/{filename}`
  - [ ] `business-logos/{business_id}/{filename}`
  - [ ] `media-gallery/{business_id}/{filename}`
  - [ ] `user-avatars/{user_id}/{filename}`
  - [ ] `blog-images/{blog_id}/{filename}`
  - [ ] TrÃ¡nh leak file qua path guessing

- [ ] **A4.5** Image optimization flow:
  - [ ] Upload â†’ Optimize â†’ Store
  - [ ] Thumbnails generation
  - [ ] CDN integration (náº¿u cÃ³)
  - [ ] Update `lib/storage.ts` vÃ  `lib/image.ts`

- [ ] **A4.6** Test storage:
  - [ ] Test upload vá»›i cÃ¡c roles
  - [ ] Test download/view vá»›i cÃ¡c roles
  - [ ] Test path security
  - [ ] Test file type validation
  - [ ] Test size limits

**Deliverables:**
- `database/storage_setup.sql` - Storage setup (náº¿u cÃ³ thá»ƒ)
- `database/STORAGE.md` - Storage documentation
- Updated `lib/storage.ts` vá»›i policies
- Test results

---

## PHáº¦N B â€“ AUTH & ROLE SYSTEM (XÆ¯Æ NG Sá»NG QUYá»€N)

### B1. Auth Flow chuáº©n hÃ³a

**Má»¥c tiÃªu:** Chuáº©n hÃ³a authentication flows cho táº¥t cáº£ user types

**Danh má»¥c:**

- [ ] **B1.1** User auth flow:
  - [ ] Registration flow
  - [ ] Login flow
  - [ ] Logout flow
  - [ ] Password reset flow
  - [ ] Session management
  - [ ] Token refresh
  - [ ] Verify implementation trong `contexts/UserSessionContext.tsx`

- [ ] **B1.2** Business owner auth flow:
  - [ ] Registration request â†’ Approval â†’ Invite â†’ First login
  - [ ] Business owner login
  - [ ] Link profile vá»›i business
  - [ ] Verify implementation trong `contexts/BusinessAuthContext.tsx`
  - [ ] Verify Edge Function `approve-registration`

- [ ] **B1.3** Admin auth flow:
  - [ ] Admin login (Supabase Auth + admin_users table lookup)
  - [ ] Disable DEV quick login á»Ÿ production
  - [ ] Admin session management
  - [ ] Verify implementation trong `contexts/AdminContext.tsx`

- [ ] **B1.4** Token lifecycle:
  - [ ] Access token
  - [ ] Refresh token
  - [ ] Token expiry handling
  - [ ] Auto refresh logic

- [ ] **B1.5** Test auth flows:
  - [ ] Test user registration â†’ login â†’ logout
  - [ ] Test business registration â†’ approval â†’ invite â†’ login
  - [ ] Test admin login
  - [ ] Test password reset
  - [ ] Test session persistence

**Deliverables:**
- Updated auth contexts (náº¿u cáº§n)
- Document auth flows trong `docs/AUTHENTICATION.md`
- Test results

---

### B2. Role & Permission Model

**Má»¥c tiÃªu:** Äá»‹nh nghÄ©a rÃµ rÃ ng roles vÃ  permissions, mapping vá»›i frontend vÃ  backend

**Danh má»¥c:**

- [ ] **B2.1** Define roles:
  - [ ] `User` - Regular user
  - [ ] `BusinessOwner` - Business owner
  - [ ] `Staff` - Staff member (future, nhÆ°ng cáº§n define structure)
  - [ ] `Admin` - Full admin
  - [ ] `Moderator` - Limited admin
  - [ ] `Editor` - Content editor only

- [ ] **B2.2** Define permissions:
  - [ ] Map permissions vá»›i `AdminPermissions` interface trong `types.ts`
  - [ ] Define business owner permissions
  - [ ] Define user permissions
  - [ ] Define staff permissions (future)

- [ ] **B2.3** Frontend guards:
  - [ ] `ProtectedRoute` component
  - [ ] `AdminProtectedRoute` component
  - [ ] Permission-based UI rendering
  - [ ] Verify táº¥t cáº£ routes cÃ³ protection Ä‘Ãºng

- [ ] **B2.4** Backend RLS mapping:
  - [ ] Map frontend roles vá»›i RLS policies
  - [ ] Ensure RLS policies match role permissions
  - [ ] Document mapping

- [ ] **B2.5** Admin permissions JSON:
  - [ ] Verify `admin_users.permissions` JSONB structure
  - [ ] Default permissions cho má»—i role
  - [ ] Permission presets trong `constants.ts`

**Deliverables:**
- `docs/ROLES_AND_PERMISSIONS.md` - Document roles vÃ  permissions
- Updated constants/permissions (náº¿u cáº§n)
- Verify frontend guards
- Verify RLS mapping

---

### B3. Registration & Approval Flow (END-TO-END)

**Má»¥c tiÃªu:** HoÃ n thiá»‡n flow tá»« registration Ä‘áº¿n business setup

**Danh má»¥c:**

- [ ] **B3.1** Partner registration:
  - [ ] Form táº¡i `/partner-registration`
  - [ ] Validation
  - [ ] Submit â†’ `registration_requests` table
  - [ ] Email notification cho admin
  - [ ] Verify `pages/PartnerRegistrationPage.tsx`

- [ ] **B3.2** Admin approve:
  - [ ] Admin xem registration requests
  - [ ] Admin approve/reject
  - [ ] Verify admin UI

- [ ] **B3.3** Edge Function `approve-registration`:
  - [ ] Review code trong `supabase/functions/approve-registration/index.ts`
  - [ ] Create business record
  - [ ] Invite user via Supabase Auth
  - [ ] Send templated email
  - [ ] Create profile
  - [ ] Link profile vá»›i business
  - [ ] Update request status
  - [ ] Error handling & rollback
  - [ ] Test function

- [ ] **B3.4** Email invite:
  - [ ] Email template 'invite'
  - [ ] Invitation link
  - [ ] Email content
  - [ ] Test email sending

- [ ] **B3.5** First login:
  - [ ] User click invitation link
  - [ ] Set password
  - [ ] Login láº§n Ä‘áº§u
  - [ ] Redirect to onboarding

- [ ] **B3.6** Business onboarding wizard:
  - [ ] Wizard steps
  - [ ] Business profile setup
  - [ ] Initial services setup
  - [ ] Verify `components/BusinessOnboardingWizard.tsx`
  - [ ] Complete flow test

**Deliverables:**
- Tested registration â†’ approval â†’ invite â†’ first login â†’ onboarding flow
- Updated Edge Function (náº¿u cáº§n)
- Email template
- Onboarding wizard hoÃ n chá»‰nh

---

## PHáº¦N C â€“ FRONTEND HOÃ€N THIá»†N (KHÃ”NG CHá»ˆ "CÃ“ UI")

### C1. Frontend Architecture Audit

**Má»¥c tiÃªu:** Cleanup vÃ  chuáº©n hÃ³a frontend architecture

**Danh má»¥c:**

- [ ] **C1.1** Context cleanup:
  - [ ] Review táº¥t cáº£ 26 contexts
  - [ ] Identify duplicated logic
  - [ ] Merge hoáº·c remove duplicate contexts
  - [ ] Optimize context providers tree
  - [ ] Document context responsibilities

- [ ] **C1.2** Data-fetch pattern:
  - [ ] Chuáº©n hÃ³a data fetching trong contexts
  - [ ] Loading states
  - [ ] Error handling
  - [ ] Refetch logic
  - [ ] Cache strategy (náº¿u cÃ³)

- [ ] **C1.3** Error boundary & loading state:
  - [ ] Error boundaries cho critical sections
  - [ ] Loading states consistent
  - [ ] Error messages user-friendly
  - [ ] Fallback UI

- [ ] **C1.4** Component structure:
  - [ ] Review component organization
  - [ ] Extract reusable components
  - [ ] Document component API

**Deliverables:**
- Cleaned up contexts
- Documented architecture trong `docs/FRONTEND_ARCHITECTURE.md`
- Error boundaries
- Consistent loading states

---

### C2. PUBLIC SITE (USER-FACING)

**Má»¥c tiÃªu:** HoÃ n thiá»‡n public-facing website

**Danh má»¥c:**

- [ ] **C2.1** Homepage:
  - [ ] Hero slides (dynamic tá»« database)
  - [ ] Featured businesses section
  - [ ] Featured deals section
  - [ ] Featured blog section
  - [ ] Explore by location section
  - [ ] Newsletter signup
  - [ ] Recently viewed
  - [ ] Verify `pages/HomePage.tsx`
  - [ ] Test vá»›i data tháº­t

- [ ] **C2.2** Directory search & filter:
  - [ ] Search functionality
  - [ ] Filter by category
  - [ ] Filter by location
  - [ ] Filter by tags
  - [ ] Sort options
  - [ ] Pagination
  - [ ] Map view
  - [ ] List view
  - [ ] Verify `pages/DirectoryPage.tsx`
  - [ ] Test search performance

- [ ] **C2.3** Business landing page:
  - [ ] Business detail page
  - [ ] Services listing
  - [ ] Deals/promotions
  - [ ] Gallery
  - [ ] Reviews & ratings
  - [ ] Team members
  - [ ] Business blog posts
  - [ ] Contact information
  - [ ] Map integration
  - [ ] Verify `pages/BusinessDetailPage.tsx`
  - [ ] Custom landing page (náº¿u business cÃ³ custom landing)

- [ ] **C2.4** Blog platform:
  - [ ] Blog list page
  - [ ] Blog post detail
  - [ ] Categories
  - [ ] Search
  - [ ] Comments
  - [ ] Related posts
  - [ ] Verify `pages/BlogListPage.tsx` vÃ  `pages/BlogPostPage.tsx`
  - [ ] Business blog posts
  - [ ] Verify `pages/BusinessPostPage.tsx`

- [ ] **C2.5** SEO, metadata, schema:
  - [ ] Meta tags cho má»—i page
  - [ ] Open Graph tags
  - [ ] Twitter cards
  - [ ] Schema.org markup
  - [ ] Sitemap generation
  - [ ] Robots.txt
  - [ ] Canonical URLs
  - [ ] Slug optimization

- [ ] **C2.6** Other pages:
  - [ ] About page
  - [ ] Contact page
  - [ ] Login/Register pages
  - [ ] Reset password page
  - [ ] 404 page

**Deliverables:**
- Táº¥t cáº£ public pages hoÃ n chá»‰nh vÃ  test vá»›i data tháº­t
- SEO optimization
- Performance optimization

---

### C3. BUSINESS DASHBOARD (CORE VALUE) - v1.1 REBASE

**Má»¥c tiÃªu:** HoÃ n thiá»‡n business dashboard vá»›i táº¥t cáº£ modules

**âš ï¸ PHáº M VI PHASE C (v1.1):**
- âœ… UI hoÃ n chá»‰nh
- âœ… CRUD hoáº¡t Ä‘á»™ng
- âœ… RLS-safe
- âœ… KhÃ´ng placeholder
- âŒ **KHÃ”NG** business automation phá»©c táº¡p
- âŒ **KHÃ”NG** business logic nÃ¢ng cao
- âŒ **KHÃ”NG** rule enforcement phá»©c táº¡p

**â¡ï¸ Business logic nÃ¢ng cao, rule enforcement, automation â†’ ÄÆ¯á»¢C CHUYá»‚N SANG PHASE D**

**âš ï¸ TRáº NG THÃI C3.4 â†’ C3.9 (v1.1):**
- CÃ¡c module C3.4 â†’ C3.9 Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u: **UI_COMPLETE / REVIEW_LATER**
- KhÃ´ng coi lÃ  DONE logic
- Sáº½ audit láº¡i khi triá»ƒn khai Phase D (Data Flow & Business Logic)
- â¡ï¸ KHÃ”NG xÃ³a code
- â¡ï¸ KHÃ”NG lÃ m láº¡i UI
- â¡ï¸ CHá»ˆ audit logic khi Ä‘áº¿n Phase D

**Checklist cho má»—i module:**

- [ ] **C3.1** Dashboard overview:
  - [ ] Statistics cards
  - [ ] Recent activities
  - [ ] Quick actions
  - [ ] Notifications
  - [ ] Verify `components/DashboardOverview.tsx`

- [ ] **C3.2** Profile editor:
  - [ ] Business info edit
  - [ ] Logo upload
  - [ ] Images upload
  - [ ] Categories selection
  - [ ] Location (address, GPS)
  - [ ] Working hours
  - [ ] Social links
  - [ ] SEO settings
  - [ ] Notification settings
  - [ ] Hero slides editor
  - [ ] Verify `components/BusinessProfileEditor.tsx`
  - [ ] Test save/update

- [ ] **C3.3** Landing page builder:
  - [ ] Custom landing page editor
  - [ ] Page sections
  - [ ] Layout editor
  - [ ] Preview
  - [ ] Publish
  - [ ] Verify `components/LayoutEditor.tsx` vÃ  `components/HomepageEditor.tsx`

- [ ] **C3.4** Services:
  - [ ] List services
  - [ ] Add service
  - [ ] Edit service
  - [ ] Delete service
  - [ ] Reorder services
  - [ ] Service images
  - [ ] Verify `components/ServicesManager.tsx`
  - [ ] Test CRUD operations

- [ ] **C3.5** Deals:
  - [ ] List deals
  - [ ] Add deal
  - [ ] Edit deal
  - [ ] Delete deal
  - [ ] Deal status (Active, Expired, Scheduled)
  - [ ] Deal images
  - [ ] Verify `components/DealsManager.tsx`
  - [ ] Test CRUD operations

- [ ] **C3.6** Media:
  - [ ] Gallery view
  - [ ] Upload images/videos
  - [ ] Delete media
  - [ ] Reorder media
  - [ ] Media categories
  - [ ] Image optimization
  - [ ] Verify `components/MediaLibrary.tsx`
  - [ ] Test upload/download

- [ ] **C3.7** Blog:
  - [ ] List blog posts
  - [ ] Create blog post (Draft/Published)
  - [ ] Edit blog post
  - [ ] Delete blog post
  - [ ] Rich text editor
  - [ ] Featured posts
  - [ ] SEO settings
  - [ ] Verify `components/BlogManager.tsx`
  - [ ] Test CRUD operations

- [ ] **C3.8** Reviews:
  - [ ] List reviews
  - [ ] Reply to reviews
  - [ ] Hide/show reviews
  - [ ] Rating statistics
  - [ ] Verify `components/ReviewsManager.tsx`
  - [ ] Test review management

- [ ] **C3.9** Booking:
  - [ ] List appointments
  - [ ] View appointment details
  - [ ] Confirm/cancel appointments
  - [ ] Calendar view
  - [ ] Filter by status
  - [ ] Verify `components/BookingsManager.tsx`
  - [ ] Test booking management

- [ ] **C3.10** Analytics:
  - [ ] Statistics dashboard
  - [ ] Page views
  - [ ] Contact clicks
  - [ ] Charts & graphs
  - [ ] Time series data
  - [ ] Verify `components/AnalyticsDashboard.tsx`
  - [ ] Test vá»›i data tháº­t

- [ ] **C3.11** Membership & billing:
  - [ ] Current membership tier
  - [ ] Membership expiry
  - [ ] Upgrade/downgrade options
  - [ ] Order history
  - [ ] Payment methods
  - [ ] Invoice generation
  - [ ] Verify `components/MembershipAndBilling.tsx`
  - [ ] Test membership flow

- [ ] **C3.12** Support:
  - [ ] Support tickets list
  - [ ] Create ticket
  - [ ] View ticket details
  - [ ] Reply to tickets
  - [ ] Ticket status
  - [ ] Verify `components/BusinessSupportCenter.tsx`
  - [ ] Test support flow

- [ ] **C3.13** Settings:
  - [ ] Account settings
  - [ ] Password change
  - [ ] Email preferences
  - [ ] Verify `components/AccountSettings.tsx`
  - [ ] Test settings update

**Deliverables:**
- Táº¥t cáº£ dashboard modules hoÃ n chá»‰nh vÃ  test vá»›i data tháº­t
- CRUD operations work correctly
- File uploads work correctly
- Data persistence verified

---

### C4. ADMIN PANEL (CONTROL TOWER)

**Má»¥c tiÃªu:** HoÃ n thiá»‡n admin panel vá»›i permission-based UI

**Danh má»¥c:**

- [ ] **C4.1** Admin auth:
  - [ ] Login page
  - [ ] Session management
  - [ ] Disable dev quick login in production
  - [ ] Verify `pages/AdminLoginPage.tsx`

- [ ] **C4.2** Permission-based UI:
  - [ ] Show/hide features based on permissions
  - [ ] Access denied messages
  - [ ] Verify táº¥t cáº£ admin features cÃ³ permission check

- [ ] **C4.3** Dashboard:
  - [ ] Statistics overview
  - [ ] Recent activities
  - [ ] Quick actions
  - [ ] Verify `components/AdminDashboardOverview.tsx`

- [ ] **C4.4** Businesses management:
  - [ ] List businesses
  - [ ] View business details
  - [ ] Edit business
  - [ ] Delete business
  - [ ] Bulk import
  - [ ] Verify `components/BusinessManagementTable.tsx`
  - [ ] Test CRUD operations

- [ ] **C4.5** Orders:
  - [ ] List orders
  - [ ] View order details
  - [ ] Update order status
  - [ ] Verify order management
  - [ ] Test order workflow

- [ ] **C4.6** Packages:
  - [ ] List membership packages
  - [ ] Create package
  - [ ] Edit package
  - [ ] Delete package
  - [ ] Verify package management
  - [ ] Test CRUD operations

- [ ] **C4.7** Content:
  - [ ] Page content editor
  - [ ] Homepage editor
  - [ ] Blog management
  - [ ] Verify content management

- [ ] **C4.8** Homepage editor:
  - [ ] Hero slides editor
  - [ ] Sections configuration
  - [ ] Preview
  - [ ] Publish
  - [ ] Verify `components/HomepageEditor.tsx`

- [ ] **C4.9** Logs:
  - [ ] Activity log viewer
  - [ ] Email notifications log
  - [ ] Filter & search logs
  - [ ] Verify log viewers

- [ ] **C4.10** Support:
  - [ ] Support tickets management
  - [ ] Reply to tickets
  - [ ] Update ticket status
  - [ ] Verify `components/AdminSupportTickets.tsx`

- [ ] **C4.11** Tools:
  - [ ] Bulk import tool
  - [ ] API health check
  - [ ] Database tools (náº¿u cÃ³)
  - [ ] Verify admin tools

- [ ] **C4.12** Other admin features:
  - [ ] Users management
  - [ ] Admin users management
  - [ ] Registration requests
  - [ ] Announcements
  - [ ] System settings
  - [ ] Theme editor

**Deliverables:**
- Táº¥t cáº£ admin features hoÃ n chá»‰nh vÃ  test vá»›i data tháº­t
- Permission-based UI working correctly
- All CRUD operations verified

---

## PHáº¦N D â€“ DATA FLOW & LOGIC NGHIá»†P Vá»¤

### D1. Membership & Billing Logic

**Má»¥c tiÃªu:** HoÃ n thiá»‡n membership vÃ  billing logic

**Danh má»¥c:**

- [ ] **D1.1** Membership packages:
  - [ ] Define packages (Free, Premium, VIP)
  - [ ] Package features
  - [ ] Package permissions
  - [ ] Package pricing
  - [ ] Verify `membership_packages` table

- [ ] **D1.2** Quyá»n theo gÃ³i:
  - [ ] Map package â†’ permissions
  - [ ] Enforce permissions trong business features
  - [ ] Check permissions trÆ°á»›c khi allow actions

- [ ] **D1.3** Membership expiry:
  - [ ] Track expiry date
  - [ ] Notify before expiry
  - [ ] Handle expired memberships
  - [ ] Downgrade to Free khi háº¿t háº¡n

- [ ] **D1.4** Gia háº¡n:
  - [ ] Renew membership
  - [ ] Extend expiry date
  - [ ] Update order status

- [ ] **D1.5** Upgrade/downgrade:
  - [ ] Upgrade flow
  - [ ] Downgrade flow
  - [ ] Prorated billing (náº¿u cÃ³)
  - [ ] Update permissions immediately

- [ ] **D1.6** Order lifecycle:
  - [ ] Create order
  - [ ] Payment (simulated hoáº·c real gateway)
  - [ ] Confirm order
  - [ ] Activate membership
  - [ ] Order status updates
  - [ ] Email notifications

**Deliverables:**
- Membership logic hoÃ n chá»‰nh
- Billing logic hoÃ n chá»‰nh
- Test membership workflows

---

### D2. Booking & Appointment Logic

**Má»¥c tiÃªu:** HoÃ n thiá»‡n booking vÃ  appointment logic

**Danh má»¥c:**

- [ ] **D2.1** Appointment slots:
  - [ ] Slot availability
  - [ ] Service duration
  - [ ] Working hours
  - [ ] Blocked time slots

- [ ] **D2.2** Appointment status:
  - [ ] Pending â†’ Confirmed â†’ Completed
  - [ ] Cancelled flow
  - [ ] Status transitions

- [ ] **D2.3** Owner vs user:
  - [ ] User táº¡o appointment
  - [ ] Owner xem appointments
  - [ ] Owner confirm/cancel
  - [ ] Permissions

- [ ] **D2.4** Notifications:
  - [ ] Email khi cÃ³ appointment má»›i
  - [ ] Email khi appointment Ä‘Æ°á»£c confirm
  - [ ] Email khi appointment bá»‹ cancel
  - [ ] In-app notifications

**Deliverables:**
- Booking logic hoÃ n chá»‰nh
- Test booking workflows
- Email notifications working

---

### D3. Review & Rating System

**Má»¥c tiÃªu:** HoÃ n thiá»‡n review vÃ  rating system

**Danh má»¥c:**

- [ ] **D3.1** Ai Ä‘Æ°á»£c review:
  - [ ] Logged-in users
  - [ ] One review per user per business
  - [ ] Business owners khÃ´ng Ä‘Æ°á»£c review business cá»§a mÃ¬nh

- [ ] **D3.2** Chá»‘ng spam:
  - [ ] Rate limiting
  - [ ] Duplicate detection
  - [ ] Moderation (náº¿u cáº§n)

- [ ] **D3.3** Reply logic:
  - [ ] Business owner reply
  - [ ] One reply per review
  - [ ] Reply notification

- [ ] **D3.4** Rating aggregation:
  - [ ] Calculate average rating
  - [ ] Update business.rating
  - [ ] Update business.review_count
  - [ ] Trigger khi cÃ³ review má»›i/update/delete

**Deliverables:**
- Review system hoÃ n chá»‰nh
- Rating aggregation working
- Test review workflows

---

## PHáº¦N E â€“ EMAIL, NOTIFICATION, EDGE FUNCTIONS

### E1. Email System hoÃ n chá»‰nh

**Má»¥c tiÃªu:** HoÃ n thiá»‡n email system vá»›i táº¥t cáº£ templates

**Danh má»¥c:**

- [ ] **E1.1** Email templates:
  - [ ] `invite` - Business registration invitation
  - [ ] `welcome` - Welcome email
  - [ ] `order_confirmation` - Order confirmation
  - [ ] `booking_confirmation` - Booking confirmation
  - [ ] `booking_cancelled` - Booking cancelled
  - [ ] `password_reset` - Password reset
  - [ ] `membership_expiry` - Membership expiry warning
  - [ ] `review_received` - New review notification
  - [ ] Táº¥t cáº£ templates cÃ³ HTML Ä‘áº¹p, responsive

- [ ] **E1.2** Resend integration:
  - [ ] Verify Resend API setup
  - [ ] Verify RESEND_API_KEY
  - [ ] Test email sending
  - [ ] Error handling

- [ ] **E1.3** Trigger points:
  - [ ] Registration approval â†’ Send invite email
  - [ ] Order created â†’ Send confirmation email
  - [ ] Booking created â†’ Send confirmation email
  - [ ] Booking confirmed â†’ Send confirmation email
  - [ ] Booking cancelled â†’ Send cancellation email
  - [ ] Password reset â†’ Send reset email
  - [ ] Review received â†’ Send notification email
  - [ ] Membership expiring â†’ Send warning email

- [ ] **E1.4** Email testing:
  - [ ] Test táº¥t cáº£ email templates
  - [ ] Test vá»›i real email addresses
  - [ ] Verify email delivery
  - [ ] Verify email content

**Deliverables:**
- Táº¥t cáº£ email templates hoÃ n chá»‰nh
- Email system working
- Test results

---

### E2. Edge Functions Audit

**Má»¥c tiÃªu:** Audit vÃ  hoÃ n thiá»‡n táº¥t cáº£ Edge Functions

**Danh má»¥c:**

- [ ] **E2.1** `approve-registration`:
  - [ ] Review code
  - [ ] Error handling
  - [ ] Rollback logic
  - [ ] Logging
  - [ ] Security
  - [ ] Test function

- [ ] **E2.2** `send-templated-email`:
  - [ ] Review code
  - [ ] Template system
  - [ ] Error handling
  - [ ] Logging
  - [ ] Security
  - [ ] Test function

- [ ] **E2.3** `create-admin-user`:
  - [ ] Review code
  - [ ] Error handling
  - [ ] Logging
  - [ ] Security
  - [ ] Test function

- [ ] **E2.4** `send-email`:
  - [ ] Review code (cÃ³ thá»ƒ lÃ  duplicate cá»§a send-templated-email)
  - [ ] Decide: keep or remove
  - [ ] Update náº¿u cáº§n

- [ ] **E2.5** General Edge Functions improvements:
  - [ ] Consistent error handling
  - [ ] Consistent logging
  - [ ] Security best practices
  - [ ] CORS handling
  - [ ] Type safety

**Deliverables:**
- All Edge Functions reviewed vÃ  improved
- Test results
- Documentation

---

### E3. Notification System

**Má»¥c tiÃªu:** HoÃ n thiá»‡n notification system

**Danh má»¥c:**

- [ ] **E3.1** In-app notifications:
  - [ ] Notification component
  - [ ] Notification storage (database hoáº·c in-memory)
  - [ ] Real-time notifications (Supabase Realtime)
  - [ ] Mark as read
  - [ ] Notification types

- [ ] **E3.2** Email notifications:
  - [ ] Integration vá»›i email system
  - [ ] User preferences
  - [ ] Notification settings

- [ ] **E3.3** Admin alerts:
  - [ ] Admin notification system
  - [ ] Critical alerts
  - [ ] Daily/weekly summaries

**Deliverables:**
- Notification system working
- Test results

---

## PHáº¦N F â€“ SEARCH, PERFORMANCE, SEO

### F1. Search System

**Má»¥c tiÃªu:** HoÃ n thiá»‡n search functionality

**Danh má»¥c:**

- [ ] **F1.1** Business search:
  - [ ] Search algorithm
  - [ ] Full-text search (PostgreSQL)
  - [ ] Search by name, category, location, tags
  - [ ] Search ranking
  - [ ] Search suggestions
  - [ ] Verify `components/SearchBar.tsx`

- [ ] **F1.2** Blog search:
  - [ ] Search blog posts
  - [ ] Search by title, content, category
  - [ ] Full-text search

- [ ] **F1.3** Index strategy:
  - [ ] Database indexes cho search columns
  - [ ] GIN indexes cho full-text search (náº¿u dÃ¹ng)
  - [ ] Verify indexes trong schema

- [ ] **F1.4** Search performance:
  - [ ] Test search performance
  - [ ] Optimize queries
  - [ ] Pagination

**Deliverables:**
- Search system hoÃ n chá»‰nh
- Performance optimized
- Test results

---

### F2. Performance Optimization

**Má»¥c tiÃªu:** Optimize performance cá»§a á»©ng dá»¥ng

**Danh má»¥c:**

- [ ] **F2.1** Query optimization:
  - [ ] Review slow queries
  - [ ] Add indexes
  - [ ] Optimize joins
  - [ ] Use select specific columns
  - [ ] Pagination

- [ ] **F2.2** Indexes:
  - [ ] Review indexes trong schema
  - [ ] Add missing indexes
  - [ ] Remove unused indexes
  - [ ] Verify index usage

- [ ] **F2.3** Pagination:
  - [ ] Implement pagination everywhere cáº§n thiáº¿t
  - [ ] Consistent pagination UI
  - [ ] Infinite scroll hoáº·c page-based

- [ ] **F2.4** Image lazy loading:
  - [ ] Lazy load images
  - [ ] Placeholder images
  - [ ] Image optimization
  - [ ] CDN (náº¿u cÃ³)

- [ ] **F2.5** Cache strategy:
  - [ ] Frontend caching (náº¿u cáº§n)
  - [ ] API response caching (náº¿u cáº§n)
  - [ ] Static asset caching

**Deliverables:**
- Performance optimized
- Test results (load times, query times)

---

### F3. SEO & DISCOVERABILITY

**Má»¥c tiÃªu:** Optimize SEO vÃ  discoverability

**Danh má»¥c:**

- [ ] **F3.1** Meta tags:
  - [ ] Title tags cho má»—i page
  - [ ] Meta description
  - [ ] Meta keywords (optional)
  - [ ] Dynamic meta tags

- [ ] **F3.2** Schema.org:
  - [ ] Business schema
  - [ ] Blog post schema
  - [ ] Review schema
  - [ ] Organization schema

- [ ] **F3.3** OpenGraph:
  - [ ] OG tags cho má»—i page
  - [ ] OG images
  - [ ] Social sharing

- [ ] **F3.4** Sitemap:
  - [ ] Generate sitemap.xml
  - [ ] Include all public pages
  - [ ] Update sitemap dynamically

- [ ] **F3.5** Robots.txt:
  - [ ] Create robots.txt
  - [ ] Allow/disallow rules

- [ ] **F3.6** Canonical URLs:
  - [ ] Canonical tags
  - [ ] Avoid duplicate content

- [ ] **F3.7** Slugs:
  - [ ] SEO-friendly slugs
  - [ ] Slug uniqueness
  - [ ] Slug generation

**Deliverables:**
- SEO optimized
- Sitemap generated
- Robots.txt created
- Test results

---

## PHáº¦N G â€“ QUALITY, TESTING, SAFETY NET

### G1. Testing Strategy

**Má»¥c tiÃªu:** Setup testing vÃ  viáº¿t tests

**Danh má»¥c:**

- [ ] **G1.1** Setup testing framework:
  - [ ] Install testing libraries (Jest, React Testing Library, etc.)
  - [ ] Setup test configuration
  - [ ] Setup test scripts

- [ ] **G1.2** Unit tests:
  - [ ] Test utility functions
  - [ ] Test components (critical ones)
  - [ ] Test contexts (critical ones)

- [ ] **G1.3** Integration tests:
  - [ ] Test auth flows
  - [ ] Test CRUD operations
  - [ ] Test business workflows

- [ ] **G1.4** Auth & RLS tests:
  - [ ] Test RLS policies
  - [ ] Test role permissions
  - [ ] Test unauthorized access

- [ ] **G1.5** Regression tests:
  - [ ] Test critical paths
  - [ ] Test edge cases
  - [ ] Test error cases

**Deliverables:**
- Testing framework setup
- Test suite (Ã­t nháº¥t cho critical paths)
- Test results

---

### G2. Error Handling & Monitoring

**Má»¥c tiÃªu:** Setup error handling vÃ  monitoring

**Danh má»¥c:**

- [ ] **G2.1** Frontend error boundary:
  - [ ] Error boundary components
  - [ ] Error logging
  - [ ] User-friendly error messages
  - [ ] Error reporting (náº¿u cÃ³)

- [ ] **G2.2** Backend logging:
  - [ ] Edge Functions logging
  - [ ] Error logging
  - [ ] Request logging

- [ ] **G2.3** Supabase logs:
  - [ ] Review Supabase logs
  - [ ] Setup log monitoring
  - [ ] Error alerts

- [ ] **G2.4** Alerts:
  - [ ] Critical error alerts
  - [ ] Performance alerts
  - [ ] Security alerts

**Deliverables:**
- Error handling implemented
- Logging setup
- Monitoring setup

---

## PHáº¦N H â€“ DEPLOYMENT & PRODUCTION READINESS

### H1. Environment Management

**Má»¥c tiÃªu:** Chuáº©n hÃ³a environment management

**Danh má»¥c:**

- [ ] **H1.1** .env.example:
  - [ ] Create .env.example file
  - [ ] List all environment variables
  - [ ] Document each variable
  - [ ] No secrets in .env.example

- [ ] **H1.2** Vercel env:
  - [ ] Setup environment variables trÃªn Vercel
  - [ ] Production env
  - [ ] Preview env (náº¿u cÃ³)
  - [ ] Verify env variables

- [ ] **H1.3** Supabase secrets:
  - [ ] Setup Edge Functions secrets
  - [ ] RESEND_API_KEY
  - [ ] Other secrets
  - [ ] Verify secrets

- [ ] **H1.4** Documentation:
  - [ ] Document environment setup
  - [ ] Document deployment process

**Deliverables:**
- .env.example file
- Environment setup documentation
- All env variables configured

---

### H2. Deployment Checklist

**Má»¥c tiÃªu:** Checklist Ä‘á»ƒ deploy production

**Danh má»¥c:**

- [ ] **H2.1** Build:
  - [ ] Frontend build succeeds
  - [ ] No build errors
  - [ ] No build warnings (critical ones)
  - [ ] Build size optimized

- [ ] **H2.2** DB migrate:
  - [ ] Run migrations
  - [ ] Verify schema
  - [ ] Verify RLS policies
  - [ ] Verify data (náº¿u cÃ³)

- [ ] **H2.3** Functions deploy:
  - [ ] Deploy Edge Functions
  - [ ] Verify functions work
  - [ ] Test functions

- [ ] **H2.4** Storage setup:
  - [ ] Create storage buckets
  - [ ] Setup storage policies
  - [ ] Test upload/download

- [ ] **H2.5** Domain:
  - [ ] Setup domain
  - [ ] DNS configuration
  - [ ] Verify domain

- [ ] **H2.6** SSL:
  - [ ] SSL certificate (Vercel auto)
  - [ ] Verify HTTPS

- [ ] **H2.7** Final checks:
  - [ ] Test production site
  - [ ] Test all critical paths
  - [ ] Test on different devices
  - [ ] Performance check
  - [ ] SEO check

**Deliverables:**
- Production deployment successful
- All checks passed
- Production site working

---

### H3. Backup & Recovery

**Má»¥c tiÃªu:** Setup backup vÃ  recovery plan

**Danh má»¥c:**

- [ ] **H3.1** DB backup:
  - [ ] Setup automated backups
  - [ ] Backup frequency
  - [ ] Backup retention
  - [ ] Test restore

- [ ] **H3.2** Storage backup:
  - [ ] Storage backup strategy
  - [ ] Backup frequency
  - [ ] Test restore

- [ ] **H3.3** Rollback plan:
  - [ ] Code rollback procedure
  - [ ] Database rollback procedure
  - [ ] Document rollback process

**Deliverables:**
- Backup strategy implemented
- Recovery plan documented
- Test backup/restore

---

## ğŸ“Š Tá»”NG Káº¾T

**Tá»•ng sá»‘ má»¥c:** ~200+ tasks  
**Estimated timeline:** 4-6 tuáº§n (tÃ¹y team size)  
**Priority order:** A â†’ B â†’ C â†’ D â†’ E â†’ F â†’ G â†’ H

**âš ï¸ LÆ¯U Ã:**
- KhÃ´ng Ä‘Æ°á»£c lÃ m lá»‡ch thá»© tá»±
- Má»—i má»¥c pháº£i hoÃ n thiá»‡n 100% trÆ°á»›c khi chuyá»ƒn sang má»¥c tiáº¿p theo
- Cáº­p nháº­t tiáº¿n Ä‘á»™ vÃ o `TIEN_DO_HOAN_THIEN.md` sau má»—i má»¥c hoÃ n thÃ nh
- BÃ¡o lá»—i ngay náº¿u phÃ¡t hiá»‡n sai sÃ³t

---

**Master Plan Version:** 1.1 (Clarification & Rebase)

**Changelog v1.1:**
- âœ… Redefined "Completion Report" â†’ "Completion Evidence (Lite)"
- âœ… Added tráº¡ng thÃ¡i tiáº¿n Ä‘á»™: DONE, UI_COMPLETE, REVIEW_LATER
- âœ… Rebase Phase C: Focus UI + CRUD, business logic â†’ Phase D
- âœ… C3.4-C3.9 marked as UI_COMPLETE/REVIEW_LATER, will audit at Phase D
- âœ… Giá»¯ nguyÃªn nguyÃªn táº¯c cá»‘t lÃµi, khÃ´ng thay Ä‘á»•i scope tá»•ng thá»ƒ  
**Last Updated:** $(date)  
**Status:** Ready for implementation

